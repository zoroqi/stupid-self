---
aliases:
- 668. 乘法表中第k小的数
- 668. kth smallest number in multiplication table
tc:
- leetcode
- algorithm
leetcode:
  num: 668
  url: https://leetcode.cn/problems/kth-smallest-number-in-multiplication-table/
  tags:
  - 数学
  - 二分查找
date: "2023-06-04"
id: "20230604111746_d5776a29c45a4110"
---

# 668. 乘法表中第k小的数

几乎每一个人都用 乘法表。但是你能在乘法表中快速找到第 k 小的数字吗？

乘法表是大小为 m x n 的一个整数矩阵，其中 `mat[i][j] == i * j`（下标从 1 开始）。

给你三个整数 m、n 和 k，请你在大小为 m x n 的乘法表中，找出并返回第 k 小的数字。

```
示例 1：

输入：m = 3, n = 3, k = 5
输出：3
解释：第 5 小的数字是 3 。

示例 2：

输入：m = 2, n = 3, k = 6
输出：6
解释：第 6 小的数字是 6 。
```

**提示：**

- `1 <= m, n <= 3 * 10^4`
- `1 <= k <= m * n`

## 愚笨的思考

### 暴力法 PlanA

可以简单把所有结果求出来后, 排序获得. 这种方式比较快也比较简单.
作为基础验证使用.

简单暴力 2min 实现完.

haskell 实现更是暴力一行搞定.

然后就是太大了, 内存装不下...
失败的测试用例是 `9895, 28405, 100787757`, 获取的 k 接近中位数. 也就是

### 使用大顶堆进行优化 PlanB

不是很像实现这个逻辑, 有点麻烦, 主要是忘了真么实现了...

如果根据前一个的方案申请 2252341248byte 崩溃的(oom), 实际上通过构建大顶堆实际上也会出现问题的, 还需要考虑别的方式.

### 有没有数学方法

`3 * 5` 的矩阵是

```
1 2 3 4 5
2 4 6 8 10
3 6 9 12 15
```

对应的排序后的数组是 `[1 2 2 3 3 4 4 5 6 6 8 9 10 12 15]`

是不是存在一个特殊的映射关系, 不需要进行排序也可以知道对应的结果位置.

好像有方法
1. 方阵中, 只需要求对角线一半可以得到完整的数据量, 不用完全进行计算.
2. 同样, 最小的一定出现在左上角的范围内, 不需要计算出完整的数组

感觉好像存在又不存在, 不知道是不是存在, 但是可以看看调整遍历的方式尽量少的计算全量数据.
只需要计算出左上角部分的内容就可一了. 算然少算不了多少, 但是可以少算一部分

根据失败的用例, 可以猜测一定存在一种特殊的函数实现这个映射, 我不需要存储任何数据, 就可以实现查找.

#### 基于计数的方法 PlanC

可以通过从 `[1..m*n]` 计算每一种情况出现的次数, 逐渐累加起来进行计算.
这样可以减少存储的空间(减少一部分)
这个统计方阵比较好统计...

比如 `3*5 10`, 可以得到的统计结果是, 可以得到
```
1 2 3 4 5 6 7 8 9 10 ... 18
1 2 2 3 1 1 1 1 1 1 ... 1
```

我实现的就是简单遍历统计, 结果是超时, 直接统计是在有点麻烦.

#### 放弃

好像统计没有什么实际的规律, 没有办法快速获得对应的结果.

### 参考答案 PlanD

答案用的是二分查找

不妨考虑一个反向问题：对于乘法表中的数字 x，它是乘法表中第几小的数字？
